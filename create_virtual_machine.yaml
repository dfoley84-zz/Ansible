---
    - name: Creating Virutal Machine from VM template
      hosts: localhost
      gather_facts: false
      connection: local
      tasks:
        - name: Virtual Machine customization 
          vmware_guest:
            validate_certs: no
            hostname: "{{ vcenter_hostname }}"
            username: "{{ vcenter_user }}"
            password: "{{ vcenter_pass }}"
            cluster : "{{ cluster_name }}"
            datacenter: "{{ datacenter_name }}"
            name: "{{ vm_name }}"
            template: "{{ vm_template }}"
            state: poweredon
            disk:
              - size_gb: "{{ disk_size }}"
                type: thin
                datastore: "{{ datastore_name }}"
            networks:
            - name: "{{ networks_name }}"
              ip: "{{ ip address }}"
              netmask: "{[ netmask_ip }}"
              gateway: "{{ gateway_ip }}"
              domain: "{{ domain_name }}"
              dns_servers:
              - "{{ dns_server_ip }}"
              - "{{ second_dns_server_ip }}"
              type: static
              device_type: "{{ network_type }}"
            hardware:
              memory_mb: "{{ vm_memory }}"
              num_cpus: "{{ vm_cpu }}"
              boot_firmware: "efi"
              version: 12
          delegate_to: localhost
           # wait_for_ip_address: True
